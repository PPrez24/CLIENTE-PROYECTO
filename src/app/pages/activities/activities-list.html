<app-header></app-header>
<main class="activities">
  <section class="welcome">
    <h1>Calendario de Actividades</h1>
    <p>Organiza y visualiza tus actividades en un calendario interactivo</p>
  </section>

  <section class="calendar-controls">
    <div class="view-toggle">
      <button class="view-btn" [class.active]="currentView === 'month'" (click)="setView('month')">Mes</button>
      <button class="view-btn" [class.active]="currentView === 'week'" (click)="setView('week')">Semana</button>
      <button class="view-btn" [class.active]="currentView === 'list'" (click)="setView('list')">Lista</button>
    </div>
    <div class="month-navigation" *ngIf="currentView !== 'list'">
      <button class="nav-btn" (click)="previousMonth()">‚Üê</button>
      <h2 class="current-month">{{ currentMonth | date:'MMMM yyyy' }}</h2>
      <button class="nav-btn" (click)="nextMonth()">‚Üí</button>
    </div>
    <a routerLink="/app/activities/new" class="action-btn">
      <span class="icon">Ôºã</span>
      <span>Nueva Actividad</span>
    </a>
  </section>

  <!-- Vista de Mes -->
  <section class="calendar-view" *ngIf="currentView === 'month'">
    <div class="calendar-grid">
      <div class="day-header" *ngFor="let day of weekDays">
        {{ day }}
      </div>
      <div class="calendar-day"
           *ngFor="let day of calendarDays"
           [class.other-month]="day.getMonth() !== currentMonth.getMonth()"
           [class.today]="isToday(day)">
        <div class="day-number">{{ day.getDate() }}</div>
        <div class="day-activities">
          <div class="activity-dot"
               *ngFor="let activity of getActivitiesForDay(day)"
               [class]="activity.type.toLowerCase()"
               [title]="activity.title">
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Vista de Semana -->
  <section class="week-view" *ngIf="currentView === 'week'">
    <div class="week-header">
      <div class="time-column">Hora</div>
      <div class="day-column" *ngFor="let day of weekDays">
        <div class="day-name">{{ day }}</div>
        <div class="day-date">{{ getWeekDayDate(day) | date:'d' }}</div>
      </div>
    </div>
    <div class="week-grid">
      <div class="time-slot" *ngFor="let hour of hours">
        <div class="time-label">{{ hour }}:00</div>
        <div class="day-slot" *ngFor="let day of weekDays">
          <div class="activity-slot"
               *ngFor="let activity of getActivitiesForTimeSlot(day, hour)"
               [class]="activity.type.toLowerCase()">
            <div class="activity-title">{{ activity.title }}</div>
            <div class="activity-time">{{ activity.time }}</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Vista de Lista -->
  <section class="list-view" *ngIf="currentView === 'list'">
    <div class="activities-list">
      <div class="activity-item" *ngFor="let activity of sortedActivities">
        <div class="activity-date">
          <div class="date">{{ activity.date | date:'d' }}</div>
          <div class="month">{{ activity.date | date:'MMM' }}</div>
        </div>

        <div class="activity-content">
          <h3>{{ activity.title }}</h3>
          <div class="activity-meta">
            <span class="type-badge" [class]="activity.type.toLowerCase()">{{ activity.type }}</span>
            <span class="time" *ngIf="activity.time">{{ activity.time }}</span>
            <span class="location" *ngIf="activity.location">üìç {{ activity.location }}</span>
          </div>
        </div>

        <div class="activity-status">
          <span class="status"
                [class.pending]="activity.status === 'pendiente'"
                [class.completed]="activity.status === 'completada'">
            {{ activity.status === 'pendiente' ? 'Pendiente' : 'Completada' }}
          </span>

          <div class="activity-actions">
            <button type="button" class="btn-small btn-edit" (click)="edit(activity)">
              Editar
            </button>
            <button type="button" class="btn-small btn-delete" (click)="askDelete(activity)">
              Eliminar
            </button>
          </div>
        </div>
      </div>

      <p *ngIf="sortedActivities.length === 0" class="no-activities">
        No tienes actividades registradas.
      </p>
    </div>
  </section>

  <!-- Modal de eliminaci√≥n -->
  <div class="dialog-overlay" *ngIf="showDeleteDialog" (click)="cancelDelete()">
    <div class="dialog" (click)="$event.stopPropagation()">
      <h3>Confirmar eliminaci√≥n</h3>
      <p>
        ¬øEst√°s seguro de que deseas eliminar la actividad
        <strong>{{ activityToDelete?.title }}</strong>?<br />
        Esta acci√≥n no se puede deshacer.
      </p>
      <div class="dialog-actions">
        <button class="btn-secondary" type="button" (click)="cancelDelete()">Cancelar</button>
        <button class="btn-danger" type="button" (click)="confirmDelete()">Eliminar</button>
      </div>
    </div>
  </div>
  <app-toast></app-toast>
</main>
<app-footer></app-footer>
