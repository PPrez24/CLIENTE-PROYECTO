<app-header></app-header>
<main class="auth">
  <h2 appHighlight="rgba(99,102,241,.15)">Crear cuenta</h2>
  <form [formGroup]="registerForm" (ngSubmit)="register()">
    <label>
      Email
      <div class="email-input-group">
        <input
          type="text"
          formControlName="emailPrefix"
          placeholder="tu.nombre"
          [class.invalid]="emailPrefix?.invalid && emailPrefix?.touched"
        />
        <span class="email-suffix">@iteso.mx</span>
      </div>
      <small class="error-message" *ngIf="emailPrefix?.invalid && emailPrefix?.touched">
        <span *ngIf="emailPrefix?.hasError('required')">El email es requerido</span>
        <span *ngIf="emailPrefix?.hasError('pattern')">Formato de email invÃ¡lido</span>
      </small>
    </label>

    <label>
      ContraseÃ±a
      <div class="password-container">
        <input
          [type]="showPassword ? 'text' : 'password'"
          formControlName="password"
          [class.invalid]="password?.invalid && password?.touched"
        />
        <button
          type="button"
          (click)="togglePassword()"
          class="toggle-password"
        >
          {{ showPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
        </button>
      </div>
      <small class="error-message" *ngIf="password?.invalid && password?.touched">
        <span *ngIf="password?.hasError('required')">La contraseÃ±a es requerida</span>
        <span *ngIf="password?.hasError('minlength')">MÃ­nimo 6 caracteres</span>
        <span *ngIf="password?.hasError('pattern')">Debe incluir al menos 1 mayÃºscula y 1 nÃºmero</span>
      </small>
    </label>

    <label>
      Confirmar contraseÃ±a
      <div class="password-container">
        <input
          [type]="showConfirmPassword ? 'text' : 'password'"
          formControlName="confirmPassword"
          [class.invalid]="(confirmPassword?.invalid || passwordMismatch) && confirmPassword?.touched"
        />
        <button
          type="button"
          (click)="toggleConfirmPassword()"
          class="toggle-password"
        >
          {{ showConfirmPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
        </button>
      </div>
      <small class="error-message" *ngIf="confirmPassword?.touched">
        <span *ngIf="confirmPassword?.hasError('required')">Confirma tu contraseÃ±a</span>
        <span *ngIf="passwordMismatch">Las contraseÃ±as no coinciden</span>
      </small>
    </label>

    <button
      class="btn"
      type="submit"
      [disabled]="registerForm.invalid || loading"
    >
      <span *ngIf="!loading">Registrarme</span>
      <span *ngIf="loading" class="spinner"></span>
    </button>
  </form>
  <p class="error" *ngIf="error">{{ error }}</p>

  <p class="register-section">
    Â¿Ya tienes cuenta?
    <a routerLink="/auth/login" class="register-btn">Inicia sesiÃ³n</a>
  </p>
</main>
<app-footer></app-footer>
